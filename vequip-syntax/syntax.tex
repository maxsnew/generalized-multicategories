\documentclass{article}

\usepackage[margin=1in]{geometry}
\usepackage{tikz-cd}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{mathpartir}

\begin{document}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{definition}{Definition}
\newcommand{\pto}{\nrightarrow}
\newcommand{\pfrom}{\nleftarrow}
\newcommand{\vcat}{\mathcal}
\newcommand{\cat}{\mathbb}
\newcommand{\vtkmnd}{\mathbb{K}\text{Mod} (\vcat{V},T)}
\newcommand{\rmod}{\text{RMod}}
\newcommand{\lmod}{\text{LMod}}

\newcommand{\id}{\text{id}}
\newcommand{\when}{\text{when}\,}
\newcommand{\sort}{\,\text{sort}}
\newcommand{\ctx}{\,\text{context}}
\newcommand{\pipe}{\,|\,}

\title{Judgment Theory: An Syntax for Virtual Equipments}
\author{Max S. New}

\maketitle

In what follows we present an internal language for virtual equipments
(TODO: cite Crutwell-Shulman, Leinster, Hermida)
%
Despite sounding slightly obscure, virtual equipments are quite useful
as ``a good place to do category theory'', that is a virtual equipment
has enough structure to define internal notions of category,
multicategory and polycategory.
%
From a type-theoretic angle and a sprinkle of Curry-Howard-Lambek
ideology, we can also see a virtual equipment as a ``good place to
study type theories'' and so we call the type theory ``judgment
theory''.

The following figures present the basic formation, primitive and
admissible and equality rules of a type theory we call judgment
theory, an internal language for virtual equipments.
%
Note that contra Crutwell-Shulman, we define a virtual equipment to be
a virtual double category with all restrictions, whereas they
additionally require the category to have all \emph{units}.
%
Judgment theory has 4 central concepts, which we will refer to
sometimes using type theoretic and at other times category-theoretic
terminology.
%
In type theoretic terminology, judgment theory has \emph{sorts} $\cat
C, \cat D, \cat E$, and \emph{types} $A,B,C$ which have a given sort
and are also \emph{parameterized} by an object of some other sort, and
so can also be thought of as \emph{functions} with input and output
sorts.
%
Next there are \emph{judgments} $P,Q,R,S$ which are parameterized by
two variables.
%
In $\alpha^o:\cat C;\beta : \cat D \pipe R$, we say $R$ depends on
$\alpha$ \emph{contravariantly} and in $\beta$ \emph{covariantly}.
%
Finally, we have \emph{terms} $s,t,u$ that are elements of some
judgment $R$ but are also parameterized by elements of some other
judgments which are given by a \emph{context} $\Phi$, which is a
``compatible string'' of judgments where the covariant variable of one
judgment is the same as the contravariant variable of the next.
%
Since these terms are parameterized by other terms, we can see these
as \emph{inference rules} for the judgments.

At other times we will want to think of these using set-theoretic
terminology, in which case we have sets $\cat C,\cat D, \cat E$,
functions/elements $A,B,C$, \emph{spans} $R,\ldots$ and morphisms of
spans $s,t,u$.
%
Finally when we develop multicategory theory we will use
category-theoretic terminology, in which the structure is most
familiar and we have categories, objects/functors,
\emph{profunctors}/bimodules and 2-cells/homomorphisms of bimodules.


\begin{figure}
  \begin{mathpar}
    \cat C \sort\\
    \inferrule*[right=Object/Type-formation]
    {\cat C \sort \and \cat D \sort}
    {\alpha : \cat C \vdash A : \cat D}\\

    \inferrule*[right=Relation/Judgment/Profunctor-formation]
    {\cat C \sort \and \cat D \sort}
    {\alpha^{o}:\cat C; \beta : \cat D \pipe R}

    \inferrule*[right=Context-formation]
    {\cat C \sort \and \cat D \sort}
    {\alpha^{o}:\cat C ; \beta:\cat D\sort \pipe \Phi \ctx}

    \inferrule*[right=Element/Term/Arrow-formation]
    {\alpha^o:\cat C; \beta : \cat D \pipe \Phi\and
      \alpha^o:\cat C; \beta : \cat D \pipe R}
    {\alpha^{o}:\cat C;\beta : \cat D \pipe \Phi \vdash t : R}

    \inferrule*[right=Substitution-formation]
    {\alpha : \cat C \vdash A : \cat C'\\
      \beta : \cat D \vdash B : \cat D'\\
      \alpha^o : \cat C; \beta : \cat D \pipe \Phi\\
      \alpha'^o : \cat C'; \beta' : \cat D' \pipe \Psi}
    {A;B \pipe \Phi\vdash \vec t : \Psi}
  \end{mathpar}
  \caption{Formation Rules of Judgment Theory}
\end{figure}

\begin{figure}
  \begin{mathpar}
    \inferrule*[right=]
    {~}
    {\alpha : \cat C \vdash \alpha : \cat C}

    \inferrule*[right=*]
    {\alpha : \cat C \vdash B : \cat D\and
    \beta : \cat D \vdash A : \cat E}
    {\alpha : \cat C \vdash A[B/\beta] : \cat E}\\

    \inferrule*[right=Restriction*]
    {\alpha^o : \cat C;\beta : \cat D \pipe R\and
      \alpha' : \cat C' \vdash A : \cat C\and
      \beta' : \cat D' \vdash B : \cat D'}
    {\alpha'^o : \cat C';\beta':\cat D' \pipe R[A/\alpha,B/\beta]}\\

    \inferrule
    {~}
    {\alpha^o : \cat C ; \alpha : \cat C \pipe \cdot}

    \inferrule
    {\alpha^o : \cat C; \beta : \cat D \pipe \Phi\and
      \beta^o : \cat D; \gamma : \cat E\pipe R}
    {\alpha^o : \cat C : \gamma : \cat E \pipe \Phi, \phi : R}

    \inferrule*[right=*]
    {\alpha^o : \cat C; \beta : \cat D \pipe \Phi\and
    \beta^o : \cat D; \gamma : \cat E \pipe \Psi}
    {\alpha^o : \cat C; \gamma : \cat E \pipe \Phi, \Psi}\\

    \inferrule*[right=]
    {\Phi \vdash t : R[A/\alpha,B/\beta]}
    {A;B \pipe \Phi \vdash t/\phi : (\phi : R)}

    \inferrule*[right=]
    {A;B \pipe \Psi \vdash \vec t : \Phi \and
      B;C \pipe \Psi' \vdash s : R[B/\beta, C/\gamma]}
    {A;C \pipe \Psi,\Psi' \vdash \vec t, s/\phi : (\Phi, \phi : R)}

    \inferrule*[right=*]
    {A;B \pipe \Psi \vdash \vec t : \Phi \and
    B;C \pipe \Psi' \vdash \vec s : \Phi'}
    {A;C \pipe \Psi,\Psi' \vdash \vec t, \vec s : \Phi,\Phi'}
    \\

    \inferrule*[right=]
    {~}
    {\alpha^o;\beta\pipe \phi : R \vdash \phi : R}
    
    \inferrule*[right=*]
    {A;B \pipe \Psi \vdash \vec s : \Phi\and
      \alpha'^o : \cat C'; \beta' : \cat D' \pipe \Phi \vdash t : R
    }
    {\alpha^o:\cat C; \beta : \cat D \pipe \Psi \vdash t[\vec s] : R[A/\alpha',B/\beta']}
  \end{mathpar}
  \caption{Basic Rules of Judgment Theory, starred rules are
    admissible, non-starred are primitive}
\end{figure}
\begin{figure}
  \begin{mathpar}
    \begin{array}{rcl}
      A[\alpha/\alpha] &=& A\\
      A[B/\beta][C/\gamma] & = & A[B[C/\gamma]/\beta]\\\\
      
      R[\alpha/\alpha,\beta/\beta] &=& R\\
      R[\alpha'.A/\alpha,\beta'.B/\beta][A'/\alpha',B'/\beta'] & = &
      R[A[A'/\alpha']/\alpha,B[B'/\beta']/\beta]\\\\
      \Phi,\cdot &=& \Phi\\
      \cdot,\Phi &=& \Phi\\
      (\Phi,\Psi),\Theta &=& \Phi,(\Psi,\Theta)\\\\
      (\vec t,\vec s),\vec u &=& \vec t, (\vec s, \vec u)\\\\
      t[\phi_1/\phi_1,\ldots\phi_n/\phi_n] &=& t\\
      t[\Psi_1.s_1/\phi_1,\ldots,\Psi_n.s_n/\phi_n][\vec u_1/\Psi_1,\ldots,\vec u_n/\Psi_n] &=& t[s_1[\vec u_1/\Psi_1]/\phi_1,\ldots,s_n[\vec u_n/\Psi_n]/\phi_n]\\
    \end{array}
  \end{mathpar}  
  \caption{Algebraic Properties of Basic Rules}
\end{figure}

\begin{figure}
  \begin{mathpar}
    \inferrule*[right=Hom-Formation]
    {\beta : \cat D \vdash A : \cat C\and
    \gamma : \cat E \vdash A' : \cat C}
    {\beta^o : \cat D;\gamma : \cat E \pipe A \to_{\cat C} A'}

    \inferrule*[right=Hom-Introduction]
    {~}
    {\alpha^o : \cat C, \alpha : \cat C | \cdot \vdash \id_{\alpha} : \alpha \to_{\cat C} \alpha}

    %% \inferrule*[right=Hom-Left (Sequent Style)]
    %% {\alpha^o,\beta|\Phi,\phi : R[\delta/\delta_1], \psi : S[\delta/\delta_2],\Psi \vdash Q }
    %% {\alpha^o,\beta|\Phi,\phi : R, \chi : \delta_1 \to \delta_2, \psi : S,\Psi \vdash Q}
    
    \inferrule*[right=Hom-Elim]
    {\beta_1^o;\beta_2\pipe\Psi \vdash f : \beta_1 \to_{C} \beta_2\and
      \alpha^o;\beta\pipe \Phi\and
      \beta^o;\gamma\pipe \Phi'\and
      \Phi,\Phi' \vdash g : R}
    {\Phi[\cdot;\beta_1/\beta],\Psi,\Phi'[\beta_2/\beta;\cdot]\vdash \when f = \id_{\beta}.~ g : R[\beta_1/\beta;\beta_2/\beta]}

    \when \id_{\alpha} = \id_{\beta}.~ g \equiv g[\alpha/\beta]

    \inferrule*[right=Hom-$\eta$]
    {...}
    {\beta_1^o : \cat C;\beta_2:\cat C\pipe \Phi \vdash f \equiv \when f = \id_{\alpha} .~ \id_{\alpha} : \beta_1 \to_{\cat C} \beta_2}
  \end{mathpar}
  \caption{Hom Sets}
\end{figure}

\section{Internal Categories and Synthetic Category Theory}

Next, we introduce the notion of category internal to our syntactic
virtual equipment and the \emph{monoids and modules} translation that
shows that, with the inclusion of hom sets, our syntax is already
suitable for doing syntactic category theory.

The benefits of our syntax become clear when we define internal
categories, functors, profunctors and transformations: the definitions
read exactly as the classical definitions.
\begin{definition}[Internal Category]
  An \emph{(internal) category} consists of
  \begin{enumerate}
  \item A sort $\cat C_0$
  \item A span $\alpha^o:C_0;\alpha' : C_0 \pipe \alpha^o \to_{\cat C} \alpha'$
  \item Identity arrows $\alpha^o : C_0; \alpha : C_0 \pipe \cdot
    \vdash \id_{\alpha} : \alpha \to_{\cat C} \alpha$.
  \item Composition $\alpha_0^o:C_0;\alpha_2:C_0\pipe \phi_0 :
    \alpha_0 \to \alpha_1, \phi_1 : \alpha_1 \to \alpha_2 \vdash
    \phi_1 \circ \phi_0 : \alpha_0 \to \alpha_2$
  \item Satisfying Unitality:
    \[ \id_{\alpha} \circ \phi = \phi = \phi \circ \id_{\alpha'}\]
  \item And Associativity:
    \[ (\phi \circ \psi) \circ \theta = \phi \circ (\psi \circ \theta) \]
  \end{enumerate}
\end{definition}

\begin{definition}[Internal Functor]
  A functor $F$ between internal categories $\cat C$ and $\cat D$ consists of
  \begin{enumerate}
  \item a function on objects $\alpha : \cat C_0 \vdash F_0 : \cat D_0$
  \item a function on arrows $\alpha_0^o : \cat C_0; \alpha_1 : \cat C_0\pipe \phi:\alpha_0 \to_{\cat C} \alpha_1 \vdash F_1(\phi) : F_0(\alpha_0) \to_{\cat D} F_0(\alpha_1)$
  \item that preserves identity:
    \[ F_1(\id_{\alpha}) = \id_{F_0(\alpha)}\]
  \item and composition:
    \[ F_1(\psi \circ \phi) = F_1(\psi) \circ F_1(\phi) \]
  \end{enumerate}
\end{definition}

\begin{definition}[Internal Profunctor]
  A profunctor $R$ between internal categories $\cat C$ and $\cat D$
  consists of
  \begin{enumerate}
  \item A span $\alpha^o : \cat C_0\pipe \beta : \cat D_0 \pipe \alpha \to_{R} \beta$
  \item $C$-composition: $\alpha_0^o:\cat C_0;\beta : \cat D_0\pipe \phi : \alpha_0 \to_{C} \alpha_1, \psi : \alpha_1 \to_{R} \beta \vdash \psi \circ_{R\cat C} \phi : \alpha_0 \to_{R} \beta$
  \item $D$-composition: $\alpha^o:\cat C_0;\beta_1 : \cat D_0\pipe \psi : \alpha \to_{R} \beta, \theta : \beta_0 \to_{\cat D} \beta_1 \vdash \theta \circ_{\cat DR} \psi : \alpha \to_{R} \beta_1$
  \item Satisfying $\cat C$ associativity: $\psi \circ_{R\cat C} (\phi_1 \circ_{\cat C} \phi_0) = (\psi \circ_{R\cat C} \phi_1) \circ_{R\cat C} \phi_0$
  \item Satisfying $\cat C$ unitality: $\psi \circ_{R\cat C} \id_{\alpha} = \psi$
  \item Satisfying $\cat D$ associativity: $(\theta_1 \circ_{\cat D} \theta_0) \circ_{\cat DR} \psi = \theta_1 \circ_{\cat D R} (\theta_0 \circ_{\cat DR} \psi)$
  \item Satisfying $\cat D$ unitality: $\id_{\beta} \circ_{\cat D R} \psi = \psi$
  \item Satisfying mixed associativity: $(\theta \circ_{\cat D R} \psi) \circ_{R \cat C} \phi = \theta \circ_{\cat D R} (\psi \circ_{R \cat C} \phi)$
  \end{enumerate}
\end{definition}

\begin{definition}[Natural Transformation]
  A transformation $F : \Phi \vdash : R$ where each of the sorts in
  $\alpha^o: \cat C;\beta : \cat D \pipe \Phi$ has a given category
  structure and each of the spans in $\Phi$ has a profunctor structure
  on those category structures is given by
  \begin{enumerate}
  \item A function $\Phi \vdash F_1 : \alpha \to_{R} \beta$
  \item Internal Naturality: For any decomposition $\Phi = \Phi_0,\phi
    : \gamma \to_{S} \delta,\psi : \delta \to_{T} \epsilon,\Phi_1$
    where $\gamma : \cat E$ and $\delta : \cat F$, $\epsilon : \cat
    G$, an equality
    \[ \Phi_0,\phi : \gamma\to_{S} \delta_0, \theta : \delta_0 \to_{\cat F} \delta_1,\psi : \delta_1\to_T \epsilon, \Phi_1 \vdash F_1[\theta \circ_{\cat F S} \phi/\phi] = F_1[\psi \circ_{T \cat F}\theta /\psi] \]
  \item Left naturality: If $\Phi = \phi : \alpha \to_{s} \gamma,\Phi'$
    then \[ F_1 \circ_{R\cat C} \psi = F_1[\phi \circ_{S\cat C} \psi]\]
  \item Right naturality: If $\Phi = \Phi', \phi : \gamma \to_{S}
    \beta$, then
    \[ \phi \circ_{\cat D R} F_1 = F_1[\psi \circ \phi/\psi]\]
  \end{enumerate}
\end{definition}

This last definition is probably unfamiliar to the reader that is not
experienced with profunctors.
%
However, we can show that the traditional definition is equivalent to
a natural transformation $\alpha : \cat C_0 \pipe \cdot \vdash
t_{\alpha} : F(\alpha) \to_{\cat D} G(\alpha')$.

\begin{definition}[Traditional Natural Transformation]
  A traditional natural transformation from $\alpha : \cat C_0 \vdash
  F(\alpha) : \cat D_0$ to $\alpha : \cat \vdash G(\alpha') : \cat
  D_0$ consists of
  \begin{enumerate}
  \item A term $\cdot \vdash t_{\alpha} : F(\alpha) \to_{\cat D} G(\alpha)$
  \item Such that
    \[ \phi : \alpha \to_{\cat C} \alpha' \vdash t_{\alpha'} \circ F_1(\phi) \equiv G_1(\phi) \circ t_{\alpha} : F(\alpha) \to_{\cat D} G(\alpha')
    \]
  \end{enumerate}
\end{definition}

\begin{theorem}[Equivalent Presentations of Natural Transformations]
  There is a bijection between traditional natural transformations $t
  : F \to G$ and profunctor homomorphisms $h : \alpha \to_{\cat C}
  \alpha' \vdash F(\alpha) \to_{\cat D} G(\alpha')$ given by
  \begin{enumerate}
  \item From a natural transformation $t$ we define a homomorphism
    $h(t)$ by composing on the $F$ side. The choice of this side is
    arbitrary and we could just as easily have used $G$ since they are
    equal by naturality.
    \[ \phi : \alpha \to_{\cat C} \alpha' \vdash t_{\alpha'} \circ F_1(\phi) : F(\alpha) \to_{\cat D} G_1(\alpha') \]
  \item From a homomorphism $\phi.h$, we define a natural transformation $t(h)$ as
    \[ \alpha \pipe \cdot \vdash h[{\id_{\alpha}}/\phi] \]
  \end{enumerate}
\end{theorem}
\begin{proof}
  First we show that the maps $h(\cdot),t(\cdot)$ actually produce
  homomorphisms and natural transformations.
  \begin{enumerate}
  \item On the left, we need to show $h(t)_{\phi} \circ F_1(\psi) =
    h(t)_{|phi \circ \psi}$. Expanding the definition, we just need
    associativity and functoriality of $F_1$:
    \begin{align*}
      h(t)_{\phi} \circ F_1(\psi) &\equiv (t_{\alpha'} \circ F_1(\phi)) \circ F_1(\psi)\\
      &\equiv t_{\alpha'} \circ F_1(\phi \circ \psi)\\
      &\equiv h(t)_{\phi \circ \psi}
    \end{align*}
    on the right, we use naturality:
    \begin{align*}
      G_1(\theta) \circ h(t)_{\phi} &\equiv G_1(\theta) \circ (t_{\alpha'} \circ F_1(\phi))\\
      &\equiv (t_{\alpha''} \circ F_1(\theta)) \circ F_1(\phi)\\
      &\equiv t_{\alpha''} \circ F_1(\theta \circ \phi)\\
      &\equiv t_{\theta \circ \phi}
    \end{align*}
  \item In the other direction, to prove naturality:
    \begin{align*}
      h[\id_\alpha/\phi] \circ F_1(\psi) &\equiv h[\id_\alpha \circ \psi/\phi]\\
      &\equiv h[\psi/\phi]\\
      &\equiv h[\psi \circ \id_{\alpha'}/\phi]\\
      &\equiv G_1(\psi) \circ h[\id_{\alpha}/\phi]
    \end{align*}
  \end{enumerate}
  Next we seek to prove that the functions are mutually inverse.
  \begin{enumerate}
  \item Round trip for homomorphisms:
    \begin{align*}
      h(t(h))_{\phi} &= t(h)_{\alpha} \circ F_1[\phi]\\
      &= h[\id_{\alpha}] \circ F_1[\phi]\\
      &= h[\id \circ \phi]\\
      &= h[\phi]
    \end{align*}
  \item Round trip for natural transformations uses the fact that
    functors preserve identity.
    \begin{align*}
      t(h(t))_{\alpha} &= h(t)_{\id_{\alpha}}\\
      &= t_{\alpha} \circ F_1[\id_{\alpha}]\\
      &= t_{\alpha} \circ \id_{F_0\alpha}\\
      &= t_{\alpha}
    \end{align*}
  \end{enumerate}
\end{proof}

\subsection{Universal Properties, Synthetically}

In a sense, the very purpose of category theory is to study universal
properties and so it is essential that our syntax provide a nice
presentation of universal properties.

Fortunately, the central placement of spans/profunctors in our syntax
makes the definition of a functor satisfying a universal property very
natural (should I introduce the unit category earlier?).

\begin{definition}[Right Representability]
  Let $\cat C, \cat D$ be categories and $\alpha^o : \cat C;\beta :
  \cat D \pipe \alpha \to_{Q} \beta$ be a profunctor between them. Then a \emph{right
    representation} of $Q$ consists of
  \begin{enumerate}
  \item A functor $\beta : \cat D \vdash G[\beta] : \cat C$
  \item An ``introduction rule'' homomorphism $\phi: \alpha \to_{Q}
    \beta \vdash I_G[\phi] : \alpha \to_{\cat C} G[\beta]$.
  \item An inverse homomorphism $\psi: \alpha \to_{\cat C} G[\beta]
    \vdash I_G^{-1}[\psi] : \alpha \to_{Q} \beta$. That is, it satisfies
    \begin{align*}
      I_G[I_G^{-1}[\psi]/\phi] &= \psi\\
      I_G^{-1}[I_G[\phi]/\psi] &= \phi
    \end{align*}
  \end{enumerate}
\end{definition}

While this is a fairly standard definition, it is likely unfamiliar to
type theorists, who may be surprised that Right Representability is
essentially the same as the definition of a negative type, which has
an introduction rule, but instead of an inverse, there is an
elimination rule, and the functoriality of the type is not primitive.
Fortunately, we can prove the equivalence between these notions
entirely synthetically.

\begin{definition}[Negative Type]
  A negative type (connective) $N$ between categories $\cat C$,$\cat D$ consists of
  \begin{enumerate}
  \item A judgment it represents $\alpha^o : \cat C;\beta : \cat D
    \pipe \alpha \to_{Q} \beta$
  \item A type $\beta : \cat D \vdash N[\beta] : \cat C$
  \item An ``introduction rule'' $\phi : \alpha \to_{Q} \beta \vdash
    I_N[\phi] : \alpha \to_{\cat C} N[\beta]$ that is a homomorphism
    \emph{on the left}:
    \[ I_N[\phi] \circ \psi \equiv I_N[\phi \circ \psi] \]
  \item An ``elimination rule'' $\beta^o:\cat D;\beta : \cat D \pipe
    \cdot \vdash \epsilon_{N}[\beta] : N[\beta] \to_{Q} \beta$
  \item Such that $\psi : \alpha \to_{\cat C} N[\beta] \vdash \epsilon_N[\beta]
    \circ_{Q} \psi : \alpha \to_{Q} \beta$ is an inverse to
    $I_{N}[\phi]$ in that
    \begin{align*}
       I_n[\epsilon_N[\beta] \circ \psi/\phi] &= \psi \quad\quad (\eta)\\
      \epsilon_N[\beta] \circ I_n[\phi] &= \phi\quad \quad (\beta)
    \end{align*}
  \end{enumerate}
\end{definition}

Part of this equivalence is the \emph{Yoneda Lemma}, which we state
now in its synthetic, parameterized form.
The usual non-parameterized Yoneda lemma can be formed if we have a
unit sort.

\begin{lemma}[Parameterized Yoneda Lemma]
  Given categories $\cat C, \cat D$ and a profunctor $\alpha^o:\cat
  C;\beta : \cat D \vdash \alpha \to_{Q} \beta$ and a function
  $\beta : \cat D \vdash G[\beta] : \cat C$, then there is an
  isomorphism between
  \begin{enumerate}
  \item Terms $\cdot \vdash t : G[\beta] \to_{Q} \beta$
  \item left-homomorphisms $\phi : \alpha \to_{\cat C} G[\beta] \vdash
    u : \alpha \to_{Q} \beta$ i.e. they satisfy homomorphism on the
    left (the other side doesn't make sense if $G$ is not a functor):
    $u[\phi \circ \psi] = u[\phi] \circ \psi$
  \end{enumerate}
\end{lemma}
\begin{proof}
  First, the constructions
  \begin{enumerate}
  \item Given $t$, we define $u(t)$ to be
    \[\phi : \alpha \to_{\cat C} G[\beta] \vdash t \circ_{Q} \phi : \alpha \to_{Q} \beta\]

    Which is a left-homomorphism because:
    \[ (t \circ_{Q} \phi) \circ_{Q} \psi = t \circ_{Q} (\phi \circ_{\cat C} \psi)\]
  \item Given $u$, we define $t(u)$ to be
    \[ \cdot \vdash u[\id_{G[\beta]}/\phi] : G[\beta] \to_{Q} \beta \]
  \end{enumerate}
  Now we show they are inverse
  \begin{enumerate}
  \item First, the very easy case, $\cdot \vdash t(u(t)) : G[\beta] \to_{Q} \beta$:
    \begin{align*}
      t \circ_{Q} \id_{G[\beta]} &= t
    \end{align*}
    by the fact that $Q$ is a profunctor.
  \item Next, $\phi : \alpha \to_{\cat C} G[\beta] \vdash u(t(u)) : \alpha \to_{Q} \beta$:
    \begin{align*}
      u[\id_{G[\beta]}/\phi] \circ_{Q} \phi &= u[\id \circ_{\cat C} \phi/\phi]\\
      &= u[\phi/\phi]\\
      &= u
    \end{align*}
    which uses the fact that $u$ is a left-homomorphism.
  \end{enumerate}
\end{proof}

\begin{theorem}[Negative Types and Right Representables are Equivalent]
  For any profunctor $\alpha^o: \cat C; \beta : \cat D \pipe \alpha
  \to_{Q} \beta$, there is a bijection between
  \begin{enumerate}
  \item Right Represntables $\beta : \cat D \vdash G[\beta] : \cat C$ for $Q$.
  \item Negative Types $\beta : \cat D \vdash N[\beta] : \cat C$
    representing $Q$.
  \end{enumerate}
\end{theorem}
\begin{proof}
  \begin{enumerate}
  \item Given a right representable $G[\beta]$, we set $N(G)[\beta] =
    G[\beta]$, the introduction rule is the same and the elimination
    rule is given as in the Yoneda lemma and the inverse property
    follows by the Yoneda isomorphism and the fact that $I_G^{-1}$ is
    an inverse for $I_G$.
  \item Given a negative type $N[\beta]$ we set $G(N)[\beta] =
    N[\beta]$, the introduction rule is the same and the inverse
    introduction rule is given as in the Yoneda lemma.  We need to
    show that $N[\beta]$ has the structure of a functor and that
    $I_{N}^{-1}$ is a homomorphism on the right with respect to that
    structure.
    Define $N_1$ as follows:
    \begin{mathpar}
      \inferrule
          {\beta_1^o:\cat D;\beta_2:\cat D \vdash \psi \circ \epsilon : N[\beta_1/\beta] \to_{Q} \beta_2\\
            \phi : N[\beta_1/\beta] \to_{Q} \beta_2 \vdash I_N[\phi] : N[\beta_1/\beta] \to_{\cat C} N[\beta_2/\beta]
          }
          {\beta_1^o:\cat D;\beta_2:\cat D\pipe \psi : \beta_1 \to_{\cat D} \beta_2 \vdash I_N[\psi \circ \epsilon_{\beta_1}/\phi] : N[\beta_1/\beta] \to_{\cat C} N[\beta_2/\beta]}
    \end{mathpar}
    We need to show functoriality.
    For identity we have
    \begin{align*}
      I_N[\id_{\beta} \circ \epsilon_{\beta}/\phi] &= I_N[\epsilon_{\beta}]\\
      &= I_N[\epsilon \circ \id_{N[\beta]}]\\
      &= id_{N[\beta]}
    \end{align*}
    For composition,
    \begin{align*}
      I_N[(\theta \circ \psi) \circ \epsilon] &= ?
    \end{align*}
  \end{enumerate}
\end{proof}

\section{Equipment of Internal Categories}

Next we show that internal categories provide us with our first
\emph{model} of judgment type theory by interpreting sorts as
categories, functions as functors, spans as profunctors and 2-cells as
natural transformations.
%
Furthermore, this model can be seen as an \emph{implementation} of
Hom-sets, we translate Judgment type theory with hom sets into
categories internal to judgmental type theory \emph{without} hom sets:
the home sets come from the category structure.

The interpretation of hom-formation and -introduction is obvious, but
elim is more interesting...

\end{document}

%% Local Variables:
%% compile-command: "pdflatex syntax.tex"
%% End:
